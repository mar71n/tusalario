<html>
<head>
<style>
table {
    background: url(Recibo_en_Blanco.png) transparent no-repeat 22 0; 
    background-size: cover; 
    font-size: 22px; 
    width: 640px; 
    height: 480px; 
    border: none; 
    color: red; 
    text-align: center; 
}
th{
    height: 300px;
}
input[type="text"]
{
    background: transparent;
    // border: none;
}
td.columna0{
    width: 52px;
}
input.columna0{
    width: 52px;
}
input.columna1{
    width: 200;
    text-align:left;
}
input.columna2{
    width: 90;
    text-align:right;
}
input.columna3{
    width: 90;
    text-align:right;
}
input.columna4{
    width: 200;
    text-align:left;
}
input.columna5{
    width: 87;
    text-align:right;
}
input.columna6{
    width: 87;
    text-align:right;
}
</style>
<script language="javascript" type="text/javascript"> 
var recibo = {};
recibo = (function(){
    // privadas
    var mostrarFilas = 18;
    var mostrarColumnas = 7;
    // API publico
    return {
        // ponerTabla
        ponerTabla: function (){
            var columnas = mostrarColumnas;
            var filas = mostrarFilas;
            var laTabla = '';
            var primerfila = '<tr>';
            for (var c = 0; c < columnas; c++){
                primerfila = primerfila + '<th> </th>';
            }
            laTabla = '';
            for (var f = 0; f < filas; f++){
                laTabla = laTabla + '<tr>';
                laTabla = laTabla +  ' <td class="columna0"> <input type="checkbox" class="columna0 fila' + f + '"/>  </td>';
                for (var c = 1; c < columnas; c++){
                    laTabla = laTabla +  ' <td> <input type="text" class="columna' + c + ' fila' + f + '"/>  </td>';
                }
                laTabla = laTabla +  '<tr>';
            }
            primerfila = primerfila + "</th></tr>";
            laTabla = '<table >' + primerfila + laTabla + '</table>';
            document.write(laTabla);
        },
        // grabarColumna
        grabarColumna: function (columna){
            var losinputs = document.getElementsByClassName("columna" + columna);
            var largo = losinputs.length;
            var coln = new Array();
            var inps0 = 0;
            for (inps=0 ; inps < largo; inps++){
                if (losinputs[inps].tagName == "INPUT"){
                    if(losinputs[inps].checked){
                        coln[inps0]=losinputs[inps].checked;
                    }else{
                        coln[inps0]=losinputs[inps].value;
                    }
                    inps0++;
                }
            }
            localStorage["col"+columna]=coln;
        },
        // grabarFila
        grabarFila: function(fila){
            var losinputs = document.getElementsByClassName("fila" + fila);
            var filn = new Array();
            // remunerativo/no remunerativo: columna 0
            filn[0] = document.getElementsByClassName("fila" + fila + " columna0")[0].checked;
            // haberes: columan 1 2 3
            filn[1] = document.getElementsByClassName("fila" + fila + " columna1")[0].value;
            filn[2] = document.getElementsByClassName("fila" + fila + " columna2")[0].value;
            filn[3] = document.getElementsByClassName("fila" + fila + " columna3")[0].value;
            // descuentos: columan 4 5 6
            filn[4] = document.getElementsByClassName("fila" + fila + " columna4")[0].value;
            filn[5] = document.getElementsByClassName("fila" + fila + " columna5")[0].value;
            filn[6] = document.getElementsByClassName("fila" + fila + " columna6")[0].value;
            // grabar
            localStorage["fila"+fila]=filn;
        },
        // grabar
        grabar: function (){
            for (f=0; f < mostrarFilas; f++){
                this.grabarFila(f);
            }
        },
        // recuperarFila
        recuperarFila: function(fila){
            var losinputs = document.getElementsByClassName("fila" + fila);
            var filn = new Array();
            filn = localStorage.getItem("fila" + fila).split(",");
            console.debug(filn);
            // remunerativo/no remunerativo: columna 0
            if (filn[0] == "true"){
                document.getElementsByClassName("fila" + fila + " columna0")[0].checked = true;
            } else {
                document.getElementsByClassName("fila" + fila + " columna0")[0].checked = false;
            }
            // haberes: columan 1 2 3
            document.getElementsByClassName("fila" + fila + " columna1")[0].value   = filn[1];
            document.getElementsByClassName("fila" + fila + " columna2")[0].value   = filn[2];
            document.getElementsByClassName("fila" + fila + " columna3")[0].value   = filn[3];
            // descuentos: columan 4 5 6
            document.getElementsByClassName("fila" + fila + " columna4")[0].value   = filn[4];
            document.getElementsByClassName("fila" + fila + " columna5")[0].value   = filn[5];
            document.getElementsByClassName("fila" + fila + " columna6")[0].value   = filn[6];
            // grabar
            localStorage["fila"+fila]=filn;
        },
        // recuperar
        recuperar: function (){
            for (f=0; f < mostrarFilas; f++){
                this.recuperarFila(f);
            }
        },
        // pegarFilas
        pegarFilas: function(){
            var lineas = document.getElementsByTagName('div');
            haberes = true;
            for (j=0 ; j < lineas.length + 1; j++){
                    var losinputs = document.getElementsByClassName("fila" + j);
                    //console.debug(lineas.item(j).childNodes[0]);
                    var valor = document.getElementsByTagName('div').item(j+1).childNodes[0].textContent.match(/[-]*[0-9]+\.[0-9]+/i);
                    var descripcion = document.getElementsByTagName('div').item(j+1).childNodes[0].textContent.replace(/[-]*[0-9]+\.[0-9]+/i,"");
                    console.debug(descripcion + " ....... " + valor);
                    if (! (descripcion.length > 0)){
                        haberes = false;
                        xj = j ;
                        j++;
                    }
                    if(haberes){
                        // haberes: columan 1 2 3
                        document.getElementsByClassName("fila" + j + " columna1")[0].value   = descripcion;
                        document.getElementsByClassName("fila" + j + " columna2")[0].value   = valor;
                        //document.getElementsByClassName("fila" + fila + " columna3")[0].value   = filn[3];
                    }
                    if(haberes == false){
                        // descuentos: columan 4 5 6
                        document.getElementsByClassName("fila" + (j-xj) + " columna4")[0].value   = descripcion;
                        document.getElementsByClassName("fila" + (j-xj) + " columna5")[0].value   = valor;
                        //document.getElementsByClassName("fila" + fila + " columna6")[0].value   = filn[6];
                    }
            }
        }
    }
}())
function runTotal(myForm) { 
    //el código va aquí //declara las variables y asigna box1 y box2. 
    var form_field1 = Number(myForm.box1.value); 
    var form_field2 = Number(myForm.box2.value); 
    //add the variables and update the total field value with the result. 
    myForm.total.value = form_field1 + form_field2; 
} 
</script> </head>
<body>
<input type="button" onClick="recibo.recuperar()" value="Recuperar recibo">
<form id="recibo">
<script>recibo.ponerTabla();</script>
<p></p>
<input type="button" onClick="recibo.grabar()" value="Grabar recibo">
<input type="reset" value="Limpiar recibo">
</form>

<div contenteditable="true" id="pegado"> Pegue desde Haberes asta el último importe AQUI </div>
<p><input type='button' value='mostra' onclick='recibo.pegarFilas()'>
<script  language="javascript" type="text/javascript">
</script>
</body>
</html>